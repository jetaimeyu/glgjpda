webpackJsonp([1],{Bcc7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Gu7T"),r=a.n(s),n=a("//Fk"),i=a.n(n),c=a("Xxa5"),o=a.n(c),l=a("mvHQ"),u=a.n(l),h=a("exGp"),f=a.n(h),p=a("Dd8w"),m=a.n(p),g=a("NYxO"),d=a("ABCa"),v=a("rHil"),I=a("pDNl"),D=a("odqc"),b=a("Znkm"),C=a("cq2Q"),k=a("8pLc"),$=a("F4+m"),y=($.a,m()({},Object(g.d)({setSelectCustomer:"setSelectCustomer"}),{goBack:function(){this.$router.back()},selectCust:function(t){var e=this;return f()(o.a.mark(function a(){var s,r,n,i;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(e.clickNum>0)){a.next=2;break}return a.abrupt("return",!1);case 2:e.clickNum+=1,s=void 0;try{s=localStorage.getItem("client")}catch(t){s=sessionStorage.getItem("client")}if(r=s?JSON.parse(s):{},n=s&&JSON.parse(s)[e.userID]||[],i=-1,n.forEach(function(e,a){e.ID===t.ID&&(i=a)}),!(i>=0)){a.next=11;break}return n.splice(i,1),a.next=11,e.getDataByID(t.ID).then(function(e){t=e});case 11:n.unshift(t),n=n.slice(0,30),r[e.userID]=n;try{localStorage.setItem("client",u()(r))}catch(t){sessionStorage.setItem("client",u()(r))}e.$bus.emit("selectedClient",t),e.setSelectCustomer(t),e.refresh("changeOrder",!1),e.refresh("changeReceive",!1),e.$router.back();case 20:case"end":return a.stop()}},a,e)}))()},onItemClick:function(t){this.tabType=t,1===t?this.init(1,1):this.getCacheClient()},upPull:function(){1==this.tabType?this.init(2):(this.$refs.scroll.forceUpdate(),this.$refs.scroll.refresh())},getDataByID:function(t){var e=this;return new i.a(function(a,s){e.getAxios("/Customer/GetCustomerInfoByID/"+t).then(function(t){a(t.Data)}).catch(function(t){})})},getCacheClient:function(){var t=void 0;try{t=localStorage.getItem("client")}catch(e){t=sessionStorage.getItem("client")}var e=t&&JSON.parse(t)[this.userID]||[];this.$refs.scroll.forceUpdate(!0),this.$refs.scroll.refresh(),this.dataList=[].concat(r()(e))},init:function(t,e){var a=this;this.$vux.loading.show({text:"加载中"}),this.page.page=e||this.page.page,this.getAxios("/Customer/GetPagedCustomerList",{page:this.page.page,count:this.page.count,customerName:this.paramName}).then(function(e){if(a.$vux.loading.hide(),e.Data.List.length>0){var s;if(a.pullUp={threshold:0,txt:{more:"加载更多",noMore:"没有更多了"}},2===t)(s=a.dataList).push.apply(s,r()(e.Data.List)),a.$refs.scroll.scroll.finishPullUp();else a.dataList=e.Data.List,a.$refs.scroll.scroll.finishPullDown(),a.$refs.scroll.forceUpdate(!0);a.page.page+=1,a.$refs.scroll.refresh()}else 1==t?(a.dataList=[],a.$refs.scroll.forceUpdate()):a.$refs.scroll.forceUpdate()}).catch(function(t){a.$vux.loading.hide()})},goTo:function(t,e){this.$router.push({path:this.backPath})}}),m()({},Object(g.e)(["customerID","customerName"])),d.a,v.a,I.a,C.a,D.a,b.a,k.a,{mixins:[$.a],data:function(){return{paramName:"",page:{page:1,count:10},pullUp:{threshold:0,txt:{more:"加载更多",noMore:"没有更多了"}},pullDown:{threshold:50,stop:20},tab:[{type:0,value:"最近访问"},{type:1,value:"我的客户"}],tabType:0,dataList:[],userID:0,clickNum:0}},mounted:function(){var t=JSON.parse(localStorage.getItem("user"));this.userID=t?t.data.UserID:0,this.onItemClick(0)},methods:m()({},Object(g.d)({setSelectCustomer:"setSelectCustomer"}),{goBack:function(){this.$router.back()},selectCust:function(t){var e=this;return f()(o.a.mark(function a(){var s,r,n,i;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(e.clickNum>0)){a.next=2;break}return a.abrupt("return",!1);case 2:e.clickNum+=1,s=void 0;try{s=localStorage.getItem("client")}catch(t){s=sessionStorage.getItem("client")}if(r=s?JSON.parse(s):{},n=s&&JSON.parse(s)[e.userID]||[],i=-1,n.forEach(function(e,a){e.ID===t.ID&&(i=a)}),!(i>=0)){a.next=11;break}return n.splice(i,1),a.next=11,e.getDataByID(t.ID).then(function(e){t=e});case 11:n.unshift(t),n=n.slice(0,30),r[e.userID]=n;try{localStorage.setItem("client",u()(r))}catch(t){sessionStorage.setItem("client",u()(r))}e.$bus.emit("selectedClient",t),e.setSelectCustomer(t),e.refresh("changeOrder",!1),e.refresh("changeReceive",!1),e.$router.back();case 20:case"end":return a.stop()}},a,e)}))()},onItemClick:function(t){this.tabType=t,1===t?this.init(1,1):this.getCacheClient()},upPull:function(){1==this.tabType?this.init(2):(this.$refs.scroll.forceUpdate(),this.$refs.scroll.refresh())},getDataByID:function(t){var e=this;return new i.a(function(a,s){e.getAxios("/Customer/GetCustomerInfoByID/"+t).then(function(t){a(t.Data)}).catch(function(t){})})},getCacheClient:function(){var t=void 0;try{t=localStorage.getItem("client")}catch(e){t=sessionStorage.getItem("client")}var e=t&&JSON.parse(t)[this.userID]||[];this.$refs.scroll.forceUpdate(!0),this.$refs.scroll.refresh(),this.dataList=[].concat(r()(e))},init:function(t,e){var a=this;this.$vux.loading.show({text:"加载中"}),this.page.page=e||this.page.page,this.getAxios("/Customer/GetPagedCustomerList",{page:this.page.page,count:this.page.count,customerName:this.paramName}).then(function(e){if(a.$vux.loading.hide(),e.Data.List.length>0){var s;if(a.pullUp={threshold:0,txt:{more:"加载更多",noMore:"没有更多了"}},2===t)(s=a.dataList).push.apply(s,r()(e.Data.List)),a.$refs.scroll.scroll.finishPullUp();else a.dataList=e.Data.List,a.$refs.scroll.scroll.finishPullDown(),a.$refs.scroll.forceUpdate(!0);a.page.page+=1,a.$refs.scroll.refresh()}else 1==t?(a.dataList=[],a.$refs.scroll.forceUpdate()):a.$refs.scroll.forceUpdate()}).catch(function(t){a.$vux.loading.hide()})},goTo:function(t,e){this.$router.push({path:this.backPath})}}),computed:m()({},Object(g.e)(["customerID","customerName"])),components:{XHeader:d.a,Group:v.a,XInput:I.a,Scroll:C.a,Tab:D.a,TabItem:b.a,NoData:k.a}}),x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide"}},[a("div",{staticClass:"select-cust"},[a("x-header",{staticStyle:{"z-index":"504"},on:{"on-enter":t.init,"on-click-back":t.goBack}},[t._v("选择客户")]),t._v(" "),a("div",{staticClass:"pt48",staticStyle:{background:"#fff"}},[a("tab",t._l(t.tab,function(e){return a("tab-item",{key:e.type,attrs:{selected:e.type===t.tabType},on:{"on-item-click":function(a){t.onItemClick(e.type)}}},[t._v(t._s(e.value))])})),t._v(" "),a("scroll",{ref:"scroll",attrs:{pullUpLoad:t.pullUp,pullDownRefresh:t.pullDown},on:{pullingUp:t.upPull,pullingDown:function(e){t.onItemClick(t.tabType)}}},[1===t.tabType?a("group",{staticStyle:{margin:"0"},attrs:{gutter:"0"}},[a("x-input",{attrs:{placeholder:"请输入客户名称"},on:{"on-enter":function(e){t.init(1,1)}},model:{value:t.paramName,callback:function(e){t.paramName="string"==typeof e?e.trim():e},expression:"paramName"}})],1):t._e(),t._v(" "),a("ul",t._l(t.dataList,function(e,s){return a("li",{key:s,staticClass:"custLi",on:{click:function(a){t.selectCust(e)}}},[t._v(t._s(e.CustomerName))])})),t._v(" "),0==t.dataList.length?a("no-data"):t._e()],1)],1)],1)])},staticRenderFns:[]};var S=a("VU/8")(y,x,!1,function(t){a("OWss")},"data-v-e6f80e06",null);e.default=S.exports},OWss:function(t,e){}});
//# sourceMappingURL=1.6211fe4e404d74d62044.js.map