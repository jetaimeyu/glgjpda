webpackJsonp([11],{"/I0/":function(t,e){},RXHw:function(t,e){},amht:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Dd8w"),n=s.n(a),i=s("ABCa"),r=s("5XJp"),o=s("oqQY"),c=s.n(o),l=s("tHI2"),u=s("NYxO"),m=(i.a,l.a,n()({},Object(u.e)(["CurrentUserID"]),{exeStr:function(){if(this.task.Executors)return this.task.Executors.map(function(t){return t.Name})},exeStr2:function(){if(this.task.Senders)return this.task.Senders.map(function(t){return t.Name})},workState:function(){return 1===this.task.TaskType?"客户跟进任务":"普通任务"},taskPriority:function(){return r.a.Proority(this.task.TaskPriority)},createTime:function(){if(this.task.BeginDate)return c()(this.task.BeginDate).format("YYYY-MM-DD HH:mm")},exeImg:function(){var t=[];return this.task.Executors.forEach(function(e,s){t.push(r.a.aImg(e.UserID))}),t},exeImg2:function(){var t=[];return this.task.Senders.forEach(function(e,s){t.push(r.a.aImg(e.UserID))}),t},addComParam:function(){return{ID:0,CommentType:1,DataID:this.$route.query.id,Content:"",ReplyID:0}}}),{data:function(){return{task:{},msg:{}}},components:{XHeader:i.a,Comments:l.a},computed:n()({},Object(u.e)(["CurrentUserID"]),{exeStr:function(){if(this.task.Executors)return this.task.Executors.map(function(t){return t.Name})},exeStr2:function(){if(this.task.Senders)return this.task.Senders.map(function(t){return t.Name})},workState:function(){return 1===this.task.TaskType?"客户跟进任务":"普通任务"},taskPriority:function(){return r.a.Proority(this.task.TaskPriority)},createTime:function(){if(this.task.BeginDate)return c()(this.task.BeginDate).format("YYYY-MM-DD HH:mm")},exeImg:function(){var t=[];return this.task.Executors.forEach(function(e,s){t.push(r.a.aImg(e.UserID))}),t},exeImg2:function(){var t=[];return this.task.Senders.forEach(function(e,s){t.push(r.a.aImg(e.UserID))}),t},addComParam:function(){return{ID:0,CommentType:1,DataID:this.$route.query.id,Content:"",ReplyID:0}}}),methods:{back:function(){if(this.$route.query.backIndex&&1==this.$route.query.backIndex){var t=plus.webview.currentWebview();plus.webview.close(t)}else this.$router.back()},getWorkInfo:function(t){var e=this;return this.Axios.get("/CrmTask/GetCrmTaskInfoByID/"+t).then(function(t){e.task=t.data.Data;var s=e.task.Executors.map(function(t){return t.UserID});s.forEach(function(t,a){t===e.CurrentUserID&&s.splice(a,1)}),e.msg={SendUsers:s,EvName:"crm-task",ImgPath:down+"/mdtcrm/CRMTask.jpg",Title:"您有一条新的任务评论消息",Content:""+e.task.TaskContent,Params:[e.task.ID]}}).catch(function(t){console.log(t)})},scrollTow:function(){this.$refs.scroll.scrollTo(0,-160,600)}},mounted:function(){var t=this;setTimeout(function(){var e=document.body.clientHeight;t.$refs["client-list"].style.height=e-48+"px",t.getWorkInfo(t.$route.query.id)},0)},beforeRouteEnter:function(t,e,s){"/"==e.path&&(window.plus?window.setTimeout(function(){plus.key.removeEventListener("backbutton",function(){}),plus.key.addEventListener("backbutton",function(){var t=plus.webview.currentWebview();plus.webview.close(t)})},0):document.addEventListener("plusready",function(){plus.key.removeEventListener("backbutton",function(){}),plus.key.addEventListener("backbutton",function(){var t=plus.webview.currentWebview();plus.webview.close(t)})})),s()}}),d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-info"},[s("div",{staticClass:"header"},[s("x-header",{attrs:{"left-options":{backText:"",preventGoBack:!0}},on:{"on-click-back":t.back}},[t._v("待办任务详情")])],1),t._v(" "),s("div",{ref:"client-list",staticClass:"task-info-box"},[s("div",[s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("执行时间:")]),t._v(" "),s("div",{staticClass:"work-txt"},[t._v(t._s(t.createTime))])]),t._v(" "),s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("创建人:")]),t._v(" "),s("div",{staticClass:"work-txt"},[t._v(t._s(t.task.CreateUserName))])]),t._v(" "),s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("执行人:")]),t._v(" "),s("div",{staticClass:"exe-list padding-l-8"},t._l(t.task.Executors,function(e,a){return s("div",{key:e.id,staticClass:"exe-item"},[s("img",{staticStyle:{"border-radius":"50%","padding-right":"3px"},attrs:{src:t.exeImg[a]}}),t._v(" "),s("span",{staticClass:"padding-l-8"},[t._v(t._s(t.exeStr[a]))])])}))]),t._v(" "),s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("抄送人:")]),t._v(" "),s("div",{staticClass:"exe-list padding-l-8"},t._l(t.task.Senders,function(e,a){return s("div",{key:e.id,staticClass:"exe-item"},[s("img",{staticStyle:{"border-radius":"50%","padding-right":"3px"},attrs:{src:t.exeImg2[a]}}),t._v(" "),s("span",{staticClass:"padding-l-8"},[t._v(t._s(t.exeStr2[a]))])])}))]),t._v(" "),s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("任务类型:")]),t._v(" "),s("div",{staticClass:"work-txt"},[t._v(t._s(t.workState))])]),t._v(" "),t.task.TaskResult?s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("备注:")]),t._v(" "),s("div",{staticClass:"work-txt"},[t._v(t._s(t.task.TaskResult))])]):t._e(),t._v(" "),s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("任务优先级:")]),t._v(" "),s("div",{staticClass:"work-txt"},[t._v(t._s(t.taskPriority))])]),t._v(" "),t.task.CustomerName?s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("客户:")]),t._v(" "),s("div",{staticClass:"work-txt"},[t._v(t._s(t.task.CustomerName))])]):t._e(),t._v(" "),t.task.LinkUserName?s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("联系人:")]),t._v(" "),s("div",{staticClass:"work-txt"},[t._v(t._s(t.task.LinkUserName))])]):t._e(),t._v(" "),s("div",{staticClass:"work-item"},[s("div",{staticClass:"work-label label-class"},[t._v("任务内容:")]),t._v(" "),s("div",{staticClass:"work-txt"},[t._v(t._s(t.task.TaskContent))])])]),t._v(" "),s("Comments",{attrs:{addParams:t.addComParam,msg:t.msg,workhfBool:!0}})],1)])},staticRenderFns:[]};var v=s("VU/8")(m,d,!1,function(t){s("/I0/")},"data-v-650a8d34",null);e.default=v.exports},iIvo:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACG0lEQVRYR+2WP2gTYRjGf+8laS2NvYIU1EERFy2xwcVBEQdB/FPExkGwo1QpKDi03upogoOFIqKuERxMMWihiyAoCA7Sq60dnSIoYhNaaprkXkmRYO31cuaSRXLr9z7P9/uel+97T/D5ZVRjUtEZYLeHpKiQ7QjJtUGRH36sxU9RtWaq7GSBU6hOAstb6KKIXAdND4VDV/x4+wcoOYsIn4fCxmkv46myM6PKnkTEONhUgEzJmQOWEhHjuJdxpuS8AXoTESP2TwBxKz8P9PsRNaHm/WzSPFL1qbUgbuW/An1NMK9roconO2WuH7YGMDC2us8Jl/fWVQcsEMVxuqLv5m/L2gaAgL4Ny7e4BSoxq3BW4LAo4YbdARXKCh8+Js2Xbj4uACrxW4UswmCQjTdplRezqZ7zIPrn2iaAQ1ZhxEAfNnXz32YOcnUu2fPIE2DAyqcFLrcCQOGJnTSH6wFMC5xpCYAybafMc22AhhM40B9mR1+It6+Lrh06dqKT798qLC6UXdc1aAsuDXexc1eIibvu0/jmeJQvuQpP06ttgHYC7QT+0wQuXNy2/g48mFxxPeHojW5yuQrPn/1sTQKRCHR0CivLG0Z6bbPuqLBWVEol91EW+CUMOiHbAH4TuC8wGjRuN72qPrZTvSOe4zg2vrTfMGRBoKPZECrGSfvO9leeANXFmFU4aqhOVH/LEUKBQZSKwpidMu/97fUL0KJOMLsqM0UAAAAASUVORK5CYII="},s80c:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAgCAYAAACPb1E+AAACz0lEQVRYR+2YX0hTYRjGn/cct9wm2xGkKC2yP5RoWmnQXRKFdFEY1UUQJGUEQUWGadnFbopUMCIkKYqI6saKrsq6EYJuxQ0VRAvC/BNKuKlT53be+JyebbjN8Jwmht/dd873PM/ve7/v/CWsgEYrgBFxIXNuTayXVXVHMiYhMwcCfu7qvO/4HStvAeS2y2y3Wb2NYJwGQU4G5HwGAw/cFnsFnKRG5kZDOlnK93m/EmF/MuEisxhc465V7saFzKseK5ZZbV0uQJHLzG3uOqUwLmRB1ehFgJqWExLMo646JT0uZP4NzyUiNC4rJNjrqlUcq5D6V2G1kvprGHLQWcnCfWYcPGzGyHAQnz74MdAf1MhsNkLpyVRkZspob/Pjc4s/inpPoRmHSua0H/0Y+BnWRk9PB6SSLuFKhQ2SFLLs6Q7g1YtJzf/Y8TXYW2TW+k+afOjvC4E4FAlXr4e1vT0BvHwe1hoGmb0lBWfPWzS/vh9BPH3s0/pl5RZszk7R+gJCwIgmjovz803Ai0nEbjoqKctAWbkVGzeFHufvmqfgbp/RcnLzTCg9lQpTCjAyrOLRwwkE51aUJODchbD2/dvp2S1hOOS84dp1MkTor8GFe8pkImzIkjE0GMT0FC9gEFpJBoYG4u1HAy4co67fxD46ljs5gKuVNLLO/8VyV4+dIFbfGFmXJXh1uWoduZG6qM+HghpfJgdmvhMQfnQsIUWPhJlvu+uUO3EhxYmCKs8ZMJ6BYNITtkRtg8tir0z8ITbnnFPp2W4mlDCQsXgYFxPRgZjjmFsZ9OUvPKYDEjV33XP0xhqr++dArpPTZJ+3nQhbIwOY0R202os6nTS+OGTiEbohhf2um96dUlBtA9HsWwSDx1UVuzvqlW96AYXeEMhZ0CrPEYn5NYjSWMVRd72jxQhAQyGFWdY1tig0mdHRYO0zCtBwSCPBEt6C/lWQHt8/7X8zMJprY/8AAAAASUVORK5CYII="},tHI2:function(t,e,s){"use strict";var a=s("woOf"),n=s.n(a),i=s("Dd8w"),r=s.n(i),o=s("62KO"),c=(s("5XJp"),s("iIvo")),l=s.n(c),u=s("s80c"),m=s.n(u),d=s("NYxO"),v=(Object,Object,Boolean,o.a,r()({},Object(d.e)(["CurrentUserID"])),{data:function(){return{list:[],param:{},contentPlace:"发表新评论",delcomShow:!1,delID:null,callStr:"",dels:l.a,mess:m.a,timer:null,comID:0}},props:{addParams:{type:Object},msg:{type:Object},workhfBool:{type:Boolean,default:!1}},components:{Confirm:o.a},computed:r()({},Object(d.e)(["CurrentUserID"])),filters:{imgPath:function(t){return apiPic+"/dXNlci9sb2dv_"+t+"_30x30.png"}},methods:{addComments:function(){var t=this;if(!this.param.Content)return this.$vux.toast.show({text:this.callStr?"请输入回复内容":"请输入评论内容！",type:"warn"}),!1;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.param.Content=t.callStr+" "+t.param.Content,t.Axios.post("/Comment/SaveCrmComment",t.param).then(function(e){if(t.param.Content="",t.callStr){t.clearStatus(),t.$vux.toast.show({text:"回复成功"});var s=r()({},t.msg);s.SendUsers=[t.comID],t.workhfBool?s.Title="您有一条新的任务评论回复消息":s.Content="您有一条新的跟进评论回复消息",t.send(s)}else t.$vux.toast.show({text:"发布成功"}),t.send(t.msg);t.getComments()})},1e3)},send:function(t){var e=this;this.Axios.post(api50+"/api/v1/Common/SendSingleEventMsg",t).then(function(t){e.comID=0}).catch(function(t){console.log(t,90)})},clearStatus:function(){this.callStr="",this.contentPlace="发表新评论",this.param.ReplyID=0},getComments:function(){var t=this,e={dataId:this.param.DataID,commentType:this.param.CommentType};this.Axios.get("/Comment/GetCrmCommentList",{params:e}).then(function(e){t.list=e.data.Data})},callCom:function(t){this.param.ReplyID=t.ID,this.contentPlace="回复 "+t.CreateUserName+" 于 "+t.CreateDate+"的评论",this.callStr="回复 @"+t.CreateUserName+":",this.comID=t.CreateUserID},emitScroll:function(){this.$emit("scrolltoEle")},delDia:function(t){this.delcomShow=!0,this.delID=t.ID},delComments:function(){var t=this;this.Axios.post("/Comment/DeleteCrmCommentInfo/"+this.delID).then(function(e){t.getComments(),t.$vux.toast.show({text:"删除成功"}),t.clearStatus()})},init:function(){this.param=n()({},this.addParams),this.getComments()}},mounted:function(){this.init()}}),C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"comments-info"},[s("div",{staticClass:"comments-header"},[s("div",{staticClass:"com-hea-lef"},[t._v("评论("+t._s(t.list.length)+")")]),t._v(" "),s("div",{staticStyle:{flex:"1"}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.param.Content,expression:"param.Content"}],staticClass:"com-hea-inp",attrs:{placeholder:t.contentPlace,maxlength:"100"},domProps:{value:t.param.Content},on:{focus:function(e){t.emitScroll()},input:function(e){e.target.composing||t.$set(t.param,"Content",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"com-hea-btn",on:{click:t.addComments}},[t._v(t._s(t.callStr?"回复":"发布"))])]),t._v(" "),s("ul",t._l(t.list,function(e,a){return s("li",{key:a,staticClass:"item"},[s("div",{staticClass:"com-avi"},[s("img",{attrs:{src:t._f("imgPath")(e.CreateUserID)}})]),t._v(" "),s("div",{staticClass:"com-cont"},[s("div",[s("span",{staticStyle:{color:"#8F9398"}},[t._v(t._s(e.CreateUserName))]),t._v(" "),s("span",{staticStyle:{color:"red","font-size":"14px"}},[t._v(t._s(e.CreateDate))])]),t._v(" "),s("div",[s("span",[t._v(t._s(e.Content))])])]),t._v(" "),s("div",{staticClass:"put-com"},[e.CreateUserID===t.CurrentUserID?s("span",{staticClass:"put-btn",on:{click:function(s){t.delDia(e)}}},[s("img",{staticClass:"put-img2",attrs:{src:t.dels}}),t._v("删除\n        ")]):t._e(),t._v(" "),s("span",{staticClass:"put-btn",on:{click:function(s){t.callCom(e)}}},[s("img",{staticClass:"put-img",attrs:{src:t.mess}}),t._v("回复\n        ")])])])})),t._v(" "),s("Confirm",{attrs:{title:"提醒",content:"确定要删除?"},on:{"on-cancel":function(e){t.delcomShow=!1},"on-confirm":t.delComments},model:{value:t.delcomShow,callback:function(e){t.delcomShow=e},expression:"delcomShow"}})],1)},staticRenderFns:[]};var f=s("VU/8")(v,C,!1,function(t){s("RXHw")},"data-v-9edc9456",null);e.a=f.exports}});
//# sourceMappingURL=11.1d1f8e9afbb215179683.js.map