webpackJsonp([10],{"1/SY":function(t,e){},RXHw:function(t,e){},iIvo:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACG0lEQVRYR+2WP2gTYRjGf+8laS2NvYIU1EERFy2xwcVBEQdB/FPExkGwo1QpKDi03upogoOFIqKuERxMMWihiyAoCA7Sq60dnSIoYhNaaprkXkmRYO31cuaSRXLr9z7P9/uel+97T/D5ZVRjUtEZYLeHpKiQ7QjJtUGRH36sxU9RtWaq7GSBU6hOAstb6KKIXAdND4VDV/x4+wcoOYsIn4fCxmkv46myM6PKnkTEONhUgEzJmQOWEhHjuJdxpuS8AXoTESP2TwBxKz8P9PsRNaHm/WzSPFL1qbUgbuW/An1NMK9roconO2WuH7YGMDC2us8Jl/fWVQcsEMVxuqLv5m/L2gaAgL4Ny7e4BSoxq3BW4LAo4YbdARXKCh8+Js2Xbj4uACrxW4UswmCQjTdplRezqZ7zIPrn2iaAQ1ZhxEAfNnXz32YOcnUu2fPIE2DAyqcFLrcCQOGJnTSH6wFMC5xpCYAybafMc22AhhM40B9mR1+It6+Lrh06dqKT798qLC6UXdc1aAsuDXexc1eIibvu0/jmeJQvuQpP06ttgHYC7QT+0wQuXNy2/g48mFxxPeHojW5yuQrPn/1sTQKRCHR0CivLG0Z6bbPuqLBWVEol91EW+CUMOiHbAH4TuC8wGjRuN72qPrZTvSOe4zg2vrTfMGRBoKPZECrGSfvO9leeANXFmFU4aqhOVH/LEUKBQZSKwpidMu/97fUL0KJOMLsqM0UAAAAASUVORK5CYII="},qila:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),n=a("//Fk"),o=a.n(n),r=a("NYxO"),l=a("oqQY"),c=a.n(l),u=a("ABCa"),d=a("rHil"),m=a("pDNl"),p=a("ALGc"),v=a("2FOq"),h=a("Msp2"),f=a("tHI2"),C=a("lzuW"),w=a("t/5y"),b=(C.a,i()({},Object(r.e)(["isMyClient","isAdmin"])),u.a,d.a,m.a,p.a,v.a,h.a,f.a,w.a,{mixins:[C.a],data:function(){return{options:{saveImg:function(t){}},types:[{key:0,value:"电话联系"},{key:1,value:"上门拜访"},{key:2,value:"微信联系"}],dataObj:{ImgAttach:[]},imgFile:[],recordFile:{},player:null,menus:[{label:"删除",key:1},{label:"修改",key:2}],show:!1,isShow:!1,user:"",addComParam:{ID:0,CommentType:2,DataID:this.$route.params.id,Content:"",ReplyID:0},isMsg:!1,isDelData:!1,reviewMsg:{EvName:"crm-follow",ImgPath:down+"/mdtcrm/CRMFollow.jpg",Title:"跟进记录",Content:"您有一条跟进记录的评论",Params:[this.$route.params.id],SendUsers:[]}}},mounted:function(){var t=this;this.$route.query.backIndex&&1==this.$route.query.backIndex?document.addEventListener("plusready",function(){t.getData(t.$route.params.id),t.recorder=plus.audio.getRecorder(),t.player=null,t.$bus.once("onSave",function(){t.getData(t.$route.params.id),t.$bus.emit("refrech")})}):(this.getData(this.$route.params.id),this.recorder=plus.audio.getRecorder(),this.player=null,this.$bus.once("onSave",function(){t.getData(t.$route.params.id),t.$bus.emit("refrech")}))},beforeDestroy:function(){this.$bus.off("onSave")},beforeRouteEnter:function(t,e,a){var s=!1;"/"==e.path&&(s=!0,window.plus?window.setTimeout(function(){plus.key.removeEventListener("backbutton",function(){}),plus.key.addEventListener("backbutton",function(){var t=plus.webview.currentWebview();plus.webview.close(t)})},0):document.addEventListener("plusready",function(){plus.key.removeEventListener("backbutton",function(){}),plus.key.addEventListener("backbutton",function(){var t=plus.webview.currentWebview();plus.webview.close(t)})})),a(function(t){t.isMsg=s})},methods:{clickRight:function(){this.isShow=!0},back:function(){if(this.$route.query.backIndex&&1==this.$route.query.backIndex){var t=plus.webview.currentWebview();plus.webview.close(t)}else this.$router.back()},saveImg:function(t){},goTo:function(){var t=this.$route.params.id,e=this.$route.query.isClient?"/client/clientDetails/addFollow":"/followup/addFollow";this.$router.push({path:e,query:{id:t}})},delData:function(){var t=this.$route.params.id,e=this;this.$vux.confirm.show({content:"确定删除该条数据？",onConfirm:function(){e.postAxios("/Customer/DeleteFollowUp/"+t).then(function(t){e.$vux.toast.show({type:"success",text:"删除成功"}),e.$bus.emit("refrech"),e.$router.back()}).catch(function(){e.$vux.toast.show({type:"cancel",text:"删除失败"})})}})},getData:function(t){var e=this;this.getAxios("/Customer/GetCustomerFollowupByID/"+t).then(function(t){e.dataObj=t.Data,e.dataObj.Senders.forEach(function(t){e.user+=t.Name+"  "}),e.dataObj.ContactType=e.formatType(e.dataObj.ContactType),e.dataObj.ImgAttach=e.dataObj.ImgAttach||[],e.dataObj.FollowupDate=c()(e.dataObj.FollowupDate).format("YYYY-MM-DD HH:mm"),e.dataObj.ImgAttach.forEach(function(t){t.src=api50+"/api/v1/File/DownLoadPic?filePath="+t.FilePath}),e.reviewMsg.SendUsers=[e.dataObj.CreateUserID]}).catch(function(t){t.ErrorMessage&&(e.isDelData=!0)})},handleRecord:function(t,e){var a=this;e?this.playRecord(e):this.download(t,"_doc/audio/").then(function(t){return a.playRecord(t)})},playRecord:function(t){var e=this;if(this.player)return this.player.stop(),this.player=null,!1;this.player=plus.audio.createPlayer(t),this.player.play(function(){e.player.stop(),e.player=null},function(t){e.player.stop(),e.player=null})},download:function(t,e,a){return new o.a(function(s,i){var n=a||api50+"/api/v1/File/DownLoadFile?filePath="+t;plus.downloader.createDownload(n,{filename:e},function(t,e){200==e?s(t.filename):i()}).start()})},formatType:function(t){var e={};try{e=this.types.find(function(e){return e.key==t})}catch(a){this.types.map(function(a){a.key==t&&(e=a)})}return e.value},isDel:function(t){return this.isAdmin||(t?(new Date).getTime()-new Date(t.replace(/-/g,"/")).getTime()<=864e5:"")}},filters:{picUrl:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return api50+"/api/v1/File/DownLoadPic?filePath="+t+"&w="+e+"&h="+a},dateFormat:function(t){return c()(t).format("YYYY-MM-DD")}},computed:i()({},Object(r.e)(["isMyClient","isAdmin"])),components:{XHeader:u.a,Group:d.a,XInput:m.a,XTextarea:p.a,Previewer:v.a,Actionsheet:h.a,Review:f.a,DelData:w.a}}),y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"slide"}},[a("div",{staticClass:"addFollow"},[a("x-header",{attrs:{"left-options":{backText:"",preventGoBack:!0}},on:{"on-click-back":t.back}},[t._v("跟进详情\n      "),t.isMyClient&&!t.isMsg?a("div",{staticClass:"topHeard",attrs:{slot:"right"},slot:"right"},[a("i",{staticClass:"iconfont icon-gengduo",staticStyle:{"font-size":"20px"},on:{click:t.clickRight}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"topList"},[a("p",{on:{click:function(e){t.goTo(),t.isShow=!1}}},[t._v("修改")]),t._v(" "),t.isDel(t.dataObj.CreateDate)?a("p",{on:{click:function(e){t.delData(),t.isShow=!1}}},[t._v("删除")]):t._e()]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"topModal",on:{click:function(e){t.isShow=!1}}})]):t._e(),t._v(" "),a("div")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isDelData,expression:"!isDelData"}],staticClass:"form",staticStyle:{"padding-top":"46px"}},[a("group",{attrs:{"label-width":"85",gutter:"0"}},[a("div",{staticClass:"cellWrap"},[a("x-input",{attrs:{title:"客户",readonly:""},model:{value:t.dataObj.CustomerName,callback:function(e){t.$set(t.dataObj,"CustomerName",e)},expression:"dataObj.CustomerName"}})],1),t._v(" "),a("div",{staticClass:"cellWrap"},[a("x-input",{attrs:{title:"联系人",readonly:""},model:{value:t.dataObj.LinkUserName,callback:function(e){t.$set(t.dataObj,"LinkUserName",e)},expression:"dataObj.LinkUserName"}})],1),t._v(" "),a("div",{staticClass:"cellWrap"},[a("x-input",{attrs:{title:"跟进时间",readonly:""},model:{value:t.dataObj.FollowupDate,callback:function(e){t.$set(t.dataObj,"FollowupDate",e)},expression:"dataObj.FollowupDate"}})],1),t._v(" "),a("div",{staticClass:"cellWrap"},[a("x-input",{attrs:{title:"联系方式",readonly:""},model:{value:t.dataObj.ContactType,callback:function(e){t.$set(t.dataObj,"ContactType",e)},expression:"dataObj.ContactType"}})],1),t._v(" "),a("div",{staticClass:"cellWrap"},[a("x-input",{attrs:{title:"跟进阶段",readonly:""},model:{value:t.dataObj.FollowupStateName,callback:function(e){t.$set(t.dataObj,"FollowupStateName",e)},expression:"dataObj.FollowupStateName"}})],1),t._v(" "),a("div",{staticClass:"cellWrap"},[a("x-input",{attrs:{title:"客户状态",readonly:""},model:{value:t.dataObj.CustomerStateName,callback:function(e){t.$set(t.dataObj,"CustomerStateName",e)},expression:"dataObj.CustomerStateName"}})],1),t._v(" "),a("div",{staticClass:"cellWrap",staticStyle:{display:"flex",padding:"10px 15px"}},[a("div",{staticStyle:{width:"105px",cursor:"default",display:"block","font-size":"14px","font-weight":"400"}},[t._v("跟进结果")]),t._v(" "),a("div",{staticStyle:{width:"1px",flex:"1",color:"#999","font-size":"14px","word-wrap":"break-word"}},[t._v(t._s(t.dataObj.ResultContent))])]),t._v(" "),a("div",{staticClass:"cellWrap"},[a("x-input",{attrs:{title:"抄送人",readonly:""},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}})],1)]),t._v(" "),a("div",{staticClass:"update"},[a("div",{staticClass:"updatePic flex"},t._l(t.dataObj.ImgAttach,function(e,s){return a("div",{key:s,staticClass:"picBoxWrap"},[a("div",{staticClass:"picBox"},[a("img",{attrs:{src:t._f("picUrl")(e.FilePath)},on:{click:function(e){t.imgShowPic(s)}}})])])})),t._v(" "),t.dataObj.AmrAttach&&t.dataObj.AmrAttach.FilePath?a("div",{staticClass:"updateRec flex"},[a("div",{staticClass:"recBox",on:{click:function(e){t.handleRecord(t.dataObj.AmrAttach.FilePath,t.dataObj.AmrAttach.path)}}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.player,expression:"!player"}],staticClass:"stopRec"}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.player,expression:"player"}],staticClass:"playRec"}),t._v("\n            "+t._s(t.dataObj.AmrAttach.FileSize)+"s\n          ")])]):t._e()]),t._v(" "),a("review",{attrs:{addParams:t.addComParam,msg:t.reviewMsg}})],1),t._v(" "),a("previewer",{ref:"previewer",attrs:{list:t.dataObj.ImgAttach,options:t.options},on:{"on-close":t.closePic}}),t._v(" "),a("del-data",{directives:[{name:"show",rawName:"v-show",value:t.isDelData,expression:"isDelData"}],attrs:{title:"跟进记录"}})],1)])},staticRenderFns:[]};var g=a("VU/8")(b,y,!1,function(t){a("1/SY")},"data-v-7db1e966",null);e.default=g.exports},s80c:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAgCAYAAACPb1E+AAACz0lEQVRYR+2YX0hTYRjGn/cct9wm2xGkKC2yP5RoWmnQXRKFdFEY1UUQJGUEQUWGadnFbopUMCIkKYqI6saKrsq6EYJuxQ0VRAvC/BNKuKlT53be+JyebbjN8Jwmht/dd873PM/ve7/v/CWsgEYrgBFxIXNuTayXVXVHMiYhMwcCfu7qvO/4HStvAeS2y2y3Wb2NYJwGQU4G5HwGAw/cFnsFnKRG5kZDOlnK93m/EmF/MuEisxhc465V7saFzKseK5ZZbV0uQJHLzG3uOqUwLmRB1ehFgJqWExLMo646JT0uZP4NzyUiNC4rJNjrqlUcq5D6V2G1kvprGHLQWcnCfWYcPGzGyHAQnz74MdAf1MhsNkLpyVRkZspob/Pjc4s/inpPoRmHSua0H/0Y+BnWRk9PB6SSLuFKhQ2SFLLs6Q7g1YtJzf/Y8TXYW2TW+k+afOjvC4E4FAlXr4e1vT0BvHwe1hoGmb0lBWfPWzS/vh9BPH3s0/pl5RZszk7R+gJCwIgmjovz803Ai0nEbjoqKctAWbkVGzeFHufvmqfgbp/RcnLzTCg9lQpTCjAyrOLRwwkE51aUJODchbD2/dvp2S1hOOS84dp1MkTor8GFe8pkImzIkjE0GMT0FC9gEFpJBoYG4u1HAy4co67fxD46ljs5gKuVNLLO/8VyV4+dIFbfGFmXJXh1uWoduZG6qM+HghpfJgdmvhMQfnQsIUWPhJlvu+uUO3EhxYmCKs8ZMJ6BYNITtkRtg8tir0z8ITbnnFPp2W4mlDCQsXgYFxPRgZjjmFsZ9OUvPKYDEjV33XP0xhqr++dArpPTZJ+3nQhbIwOY0R202os6nTS+OGTiEbohhf2um96dUlBtA9HsWwSDx1UVuzvqlW96AYXeEMhZ0CrPEYn5NYjSWMVRd72jxQhAQyGFWdY1tig0mdHRYO0zCtBwSCPBEt6C/lWQHt8/7X8zMJprY/8AAAAASUVORK5CYII="},"t/5y":function(t,e,a){"use strict";var s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flex just-ct",staticStyle:{"align-items":"center",height:"100%",background:"#f0f2ff"}},[e("div",{staticStyle:{"text-align":"center","line-height":"2",color:"#999"}},[e("i",{staticClass:"iconfont icon-gantanhao-xianxingsanjiaokuang",staticStyle:{"font-size":"20px"}}),this._v(" "),e("p",[this._v(this._s(this.title)+"已被删除")]),this._v(" "),e("p",[this._v("点击返回...")])])])},staticRenderFns:[]};var i=a("VU/8")({name:"DelData",props:{title:""}},s,!1,function(t){a("yw/z")},null,null);e.a=i.exports},tHI2:function(t,e,a){"use strict";var s=a("woOf"),i=a.n(s),n=a("Dd8w"),o=a.n(n),r=a("62KO"),l=(a("5XJp"),a("iIvo")),c=a.n(l),u=a("s80c"),d=a.n(u),m=a("NYxO"),p=(Object,Object,Boolean,r.a,o()({},Object(m.e)(["CurrentUserID"])),{data:function(){return{list:[],param:{},contentPlace:"发表新评论",delcomShow:!1,delID:null,callStr:"",dels:c.a,mess:d.a,timer:null,comID:0}},props:{addParams:{type:Object},msg:{type:Object},workhfBool:{type:Boolean,default:!1}},components:{Confirm:r.a},computed:o()({},Object(m.e)(["CurrentUserID"])),filters:{imgPath:function(t){return apiPic+"/dXNlci9sb2dv_"+t+"_30x30.png"}},methods:{addComments:function(){var t=this;if(!this.param.Content)return this.$vux.toast.show({text:this.callStr?"请输入回复内容":"请输入评论内容！",type:"warn"}),!1;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.param.Content=t.callStr+" "+t.param.Content,t.Axios.post("/Comment/SaveCrmComment",t.param).then(function(e){if(t.param.Content="",t.callStr){t.clearStatus(),t.$vux.toast.show({text:"回复成功"});var a=o()({},t.msg);a.SendUsers=[t.comID],t.workhfBool?a.Title="您有一条新的任务评论回复消息":a.Content="您有一条新的跟进评论回复消息",t.send(a)}else t.$vux.toast.show({text:"发布成功"}),t.send(t.msg);t.getComments()})},1e3)},send:function(t){var e=this;this.Axios.post(api50+"/api/v1/Common/SendSingleEventMsg",t).then(function(t){e.comID=0}).catch(function(t){console.log(t,90)})},clearStatus:function(){this.callStr="",this.contentPlace="发表新评论",this.param.ReplyID=0},getComments:function(){var t=this,e={dataId:this.param.DataID,commentType:this.param.CommentType};this.Axios.get("/Comment/GetCrmCommentList",{params:e}).then(function(e){t.list=e.data.Data})},callCom:function(t){this.param.ReplyID=t.ID,this.contentPlace="回复 "+t.CreateUserName+" 于 "+t.CreateDate+"的评论",this.callStr="回复 @"+t.CreateUserName+":",this.comID=t.CreateUserID},emitScroll:function(){this.$emit("scrolltoEle")},delDia:function(t){this.delcomShow=!0,this.delID=t.ID},delComments:function(){var t=this;this.Axios.post("/Comment/DeleteCrmCommentInfo/"+this.delID).then(function(e){t.getComments(),t.$vux.toast.show({text:"删除成功"}),t.clearStatus()})},init:function(){this.param=i()({},this.addParams),this.getComments()}},mounted:function(){this.init()}}),v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comments-info"},[a("div",{staticClass:"comments-header"},[a("div",{staticClass:"com-hea-lef"},[t._v("评论("+t._s(t.list.length)+")")]),t._v(" "),a("div",{staticStyle:{flex:"1"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.param.Content,expression:"param.Content"}],staticClass:"com-hea-inp",attrs:{placeholder:t.contentPlace,maxlength:"100"},domProps:{value:t.param.Content},on:{focus:function(e){t.emitScroll()},input:function(e){e.target.composing||t.$set(t.param,"Content",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"com-hea-btn",on:{click:t.addComments}},[t._v(t._s(t.callStr?"回复":"发布"))])]),t._v(" "),a("ul",t._l(t.list,function(e,s){return a("li",{key:s,staticClass:"item"},[a("div",{staticClass:"com-avi"},[a("img",{attrs:{src:t._f("imgPath")(e.CreateUserID)}})]),t._v(" "),a("div",{staticClass:"com-cont"},[a("div",[a("span",{staticStyle:{color:"#8F9398"}},[t._v(t._s(e.CreateUserName))]),t._v(" "),a("span",{staticStyle:{color:"red","font-size":"14px"}},[t._v(t._s(e.CreateDate))])]),t._v(" "),a("div",[a("span",[t._v(t._s(e.Content))])])]),t._v(" "),a("div",{staticClass:"put-com"},[e.CreateUserID===t.CurrentUserID?a("span",{staticClass:"put-btn",on:{click:function(a){t.delDia(e)}}},[a("img",{staticClass:"put-img2",attrs:{src:t.dels}}),t._v("删除\n        ")]):t._e(),t._v(" "),a("span",{staticClass:"put-btn",on:{click:function(a){t.callCom(e)}}},[a("img",{staticClass:"put-img",attrs:{src:t.mess}}),t._v("回复\n        ")])])])})),t._v(" "),a("Confirm",{attrs:{title:"提醒",content:"确定要删除?"},on:{"on-cancel":function(e){t.delcomShow=!1},"on-confirm":t.delComments},model:{value:t.delcomShow,callback:function(e){t.delcomShow=e},expression:"delcomShow"}})],1)},staticRenderFns:[]};var h=a("VU/8")(p,v,!1,function(t){a("RXHw")},"data-v-9edc9456",null);e.a=h.exports},"yw/z":function(t,e){}});
//# sourceMappingURL=10.5099188729a2d0e22a3c.js.map